"use strict";var User=require("../models/user.model"),md5=require("md5");module.exports.login=function(e,r){return r.render("auth/login")},module.exports.postLogin=function(r,n){var o,t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:o=r.body.name,t=md5(r.body.password),User.find({name:o,password:t}).then(function(e){0===e.length&&n.render("auth/login",{errors:["Check again username and password "],values:r.body})}),User.find({name:o,password:t}).lean().then(function(e){e.forEach(function(e){n.cookie("userID",e._id,{signed:!0});var r=Buffer.from(e.type+e.name).toString("base64");n.cookie("type",r),"Admin"===Buffer.from(r,"base64").toString("ascii").slice(0,5).toString()?n.redirect("/admin"):n.redirect("/users")})});case 4:case"end":return e.stop()}})},module.exports.logOut=function(e,r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:r.clearCookie("userID"),r.redirect("/");case 2:case"end":return e.stop()}})};