"use strict";var User=require("../models/user.model"),Order=require("../models/order.model"),md5=require("md5");module.exports.index=function(e,r){var s=Buffer.from(e.cookies.type,"base64").toString("ascii");User.find({type:"Store"}).then(function(e){r.render("users/index",{users:e,idCookie:s.slice(5)})})},module.exports.searchUser=function(e,r){var s=e.query.q.toLowerCase();User.find({name:s}).then(function(e){r.render("users/index",{users:e})})},module.exports.searchRecord=function(r,s){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n=r.query.q.toLowerCase(),Order.find({product:n}).then(function(e){s.render("users/userOrder",{users:e})});case 2:case"end":return e.stop()}})},module.exports.postCreate=function(e,r,s){var n=e.body;n.password=md5(e.body.password),n.avatar=e.file.path.split("/").slice(1).join("/"),User.create(e.body),r.redirect("/users")},module.exports.createOrder=function(e,r){r.render("users/createOrder",{userName:e.params.id})},module.exports.userRecord=function(e,r){var s=e.params.id;Order.find({Store:s}).lean().then(function(e){r.render("users/userOrder",{users:e})})},module.exports.editOrder=function(e,r){var s=e.params.id;Order.find({_id:s}).lean().then(function(e){r.render("users/editOrder",{users:e})})},module.exports.getUser=function(e,r){var s=e.params.id;Order.find({Store:s}).lean().then(function(e){r.render("users/view",{users:e,store:s})})};